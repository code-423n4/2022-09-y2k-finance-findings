- When `block.timestamp = epochEnd`, both `triggerDepeg` and `triggerEndEpoch` is potentially callable, because the functions require that the timestamp is <= or >=, respectively. When the depeg happens exactly at this timestamp, there is a huge incentive for capital providers to call `triggerEndEpoch`, whereas the insured persons want to call `triggerDepeg`. It is recommended to change one of the functions to enforce a strict inequality to avoid such situations where frontrunning can be very profitable.
- `Vault.depositETH` only makes sense (and works) when the underlying asset is WETH. Consider checking that and including a helpful error when the asset is not WETH, but the user still calls the functions.
- `Vault.getNextEpoch` assumes that the `epochs` array is chronologically sorted, which is not enforced. If this is not the case, the returned value will be wrong.
- `RewardsFactory.createStakingRewards` can be called for a pair where `hashedIndex_StakingRewards[hashedIndex]` already exists. Consider checking that there are no staking awards yet for the pair. Changes to this dict could confuse third-party applications which assume that the staking reward addresses for a given pair remain constant (which makes sense in my opinion).